---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\Housing_git\nss\Survey_NSS\NSS68\02_NSS68_Residual_Income_Affordability.log
  log type:  text
 opened on:   8 Dec 2020, 10:46:58

. set linesize 255

. 
. ***************************************************************
. *Step 1: Estimate the housing consumption per household member. 
. ***************************************************************
. use "${r_input}\bk_12.dta",clear

. merge m:1 ID using "${r_input}\bk_3.dta"
(label state already defined)
(label B1_v04 already defined)
(label B1_v05 already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                         3,562,593  (_merge==3)
    -----------------------------------------

. drop _merge

. 
. gen hh_size = B3_v01

.    
. /* poverty line is by state and by sector */
. 
.     *estimate housing related expenditure:
.           
.           *Rent (12: 26, 30 days recall period)
.           gen double rent = B12_v06*(B12_v01 == 26)

.           
.           *Fuel and light (12: 18, 30 days recall period)
.           gen double fuel = B12_v06*(B12_v01 == 18)

.         
.           *Collapse at household level 
.           foreach var in rent fuel { 
  2.           egen double total_`var' = sum(`var'), by(ID)
  3.           } 

.           bys ID: keep if _n == 1 // keep only one observation for each HH
(3,460,931 observations deleted)

.         
. merge 1:m ID using "${r_input}\bk_10.dta"
(note: variable B1_v00 was byte, now int to accommodate using data's values)
(label B1_v05 already defined)
(label B1_v04 already defined)
(label state already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                            33
        from master                        33  (_merge==1)
        from using                          0  (_merge==2)

    matched                         2,362,394  (_merge==3)
    -----------------------------------------

. drop _merge

.      
.          *water charge(10: 540, 30 days recall period)
.          keep if B10_v02 == 540
(2,329,875 observations deleted)

.          egen double total_water = sum(B10_v03), by(ID)

.          bys ID: keep if _n == 1 // keep only one observation for each HH
(0 observations deleted)

.         
.         *Total housing expenditure
.         egen double exp_housing = rowtotal(total_rent total_fuel total_water)

. 
.     *Housing consumption per capita
.         gen double total_exp_housing_pp = exp_housing/hh_size

. 
. ******************************************************************************
. *Step 2: Estimate the non-housing expenditure for household at national pline
. ******************************************************************************
. rename ID hhid

. merge 1:1 hhid using "${r_input}\poverty68.dta"
(label state already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                        69,110
        from master                         0  (_merge==1)
        from using                     69,110  (_merge==2)

    matched                            32,552  (_merge==3)
    -----------------------------------------

. keep if _merge == 3
(69,110 observations deleted)

. drop _merge

. 
.    gen urban = (B1_v05 == 2) 

.    keep if urban == 1
(13,420 observations deleted)

.    
.    *different budget scenario: pline, double pline, triple pline.    
.    forvalues i = 1/3 {
  2.    gen pline_`i' = pline*`i'
  3.    gen delta_pline_`i' = (abs(mpce_mrp - pline_`i')/pline_`i' * 100 <= 10) //find households around poverty line
  4.    tab delta_pline_`i'
  5.    }

delta_pline |
         _1 |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     17,869       93.40       93.40
          1 |      1,263        6.60      100.00
------------+-----------------------------------
      Total |     19,132      100.00

delta_pline |
         _2 |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     16,681       87.19       87.19
          1 |      2,451       12.81      100.00
------------+-----------------------------------
      Total |     19,132      100.00

delta_pline |
         _3 |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     17,071       89.23       89.23
          1 |      2,061       10.77      100.00
------------+-----------------------------------
      Total |     19,132      100.00

.    
.    *Non-housing consumption per capita
.    gen double exp_non_housing_pp = mpce_mrp - total_exp_housing_pp

.    
. save "${r_output}\ria_1.dta",replace
file C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\NSS68\Data Output Files\ria_1.dta saved

. 
.    *find the median non_housing consumption by state by scenario
.    keep if total_rent > 0 & !mi(total_rent) //using households that paid rent for budget standard
(14,952 observations deleted)

.    forvalues i = 1/3{
  2.    use "${r_output}\ria_1.dta",clear
  3.    
.    keep if delta_pline_`i' == 1 
  4.    egen double exp_non_housing_pp_line_`i' = median(exp_non_housing_pp), by(state)
  5.    
.    bys state: keep if _n == 1
  6.    keep state exp_non_housing_pp_line_`i'
  7.  
.    save "${r_output}\ria_non_housing_line_`i'.dta",replace
  8.    }
(17,869 observations deleted)
(1,230 observations deleted)
file C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\NSS68\Data Output Files\ria_non_housing_line_1.dta saved
(16,681 observations deleted)
(2,417 observations deleted)
file C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\NSS68\Data Output Files\ria_non_housing_line_2.dta saved
(17,071 observations deleted)
(2,030 observations deleted)
file C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\NSS68\Data Output Files\ria_non_housing_line_3.dta saved

.    
.    use "${r_output}\ria_non_housing_line_1.dta",clear

.    forvalues i = 2/3{
  2.    merge 1:1 state using "${r_output}\ria_non_housing_line_`i'.dta"
  3.    drop _merge
  4.    }
(label state already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             1
        from master                         0  (_merge==1)
        from using                          1  (_merge==2)

    matched                                33  (_merge==3)
    -----------------------------------------
(label state already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             3
        from master                         3  (_merge==1)
        from using                          0  (_merge==2)

    matched                                31  (_merge==3)
    -----------------------------------------

.    
. save "${r_output}\ria_non_housing_line.dta",replace
file C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\NSS68\Data Output Files\ria_non_housing_line.dta saved

.    
. merge 1:m state using "${r_output}\ria_1.dta"
(label state already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                            19,132  (_merge==3)
    -----------------------------------------

. keep if _merge == 3 //only on urban sector
(0 observations deleted)

. drop _merge  

. 
.         *find the affordable housings
.         forvalues i = 1/3 {
  2.     gen affordable_`i' = (exp_non_housing_pp > exp_non_housing_pp_line_`i')*100
  3.     tab affordable_`i' [aw = hhwt]
  4.     }

affordable_ |
          1 |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 1,463.0974        7.65        7.65
        100 |17,668.9026       92.35      100.00
------------+-----------------------------------
      Total |     19,132      100.00

affordable_ |
          2 |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 8,764.6168       45.81       45.81
        100 | 10,367.383       54.19      100.00
------------+-----------------------------------
      Total |     19,132      100.00

affordable_ |
          3 |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 13,578.963       70.98       70.98
        100 |5,553.03678       29.02      100.00
------------+-----------------------------------
      Total |     19,132      100.00

.         
. save "${r_output}\ria_final.dta",replace
file C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\NSS68\Data Output Files\ria_final.dta saved

. 
. ******************************************************************************
. *Step 3: stats by consumption quintile 
. ******************************************************************************
. use "${r_output}\ria_final.dta",clear

. 
. * the affordability by quintile. 
. xtile mpce_qt = mpce_mrp [aw = hhwt] , n(5)

. global var_tab_1 "affordable_1 affordable_2 affordable_3"

. 
. qui eststo total : estpost summarize $var_tab_1 [aw = hhwt],de

. forvalues i = 1/5 {
  2. qui eststo q`i' : estpost summarize $var_tab_1 [aw = hhwt] if mpce_qt == `i',de
  3. }

. esttab total q1 q2 q3 q4 q5, cells(mean(fmt(%15.0fc))) label collabels(none) ///
>  mtitles("All" "Q1" "Q2" "Q3" "Q4" "Q5") stats(N, label("Observations") fmt(%15.0gc)) /// 
>  title("Table 1. Share of Households Living in Affordable Houses by Consumption Expenditure Quintile in Urban India (2012)") varwidth(40) ///
>  addnote("Notes: Households weighted by survey weights." ///
>  "       The analysis is using the Residual Income Approach." ///
>  "       The affordable_1 is estimated using renters' non-housing expenses drawn from India's urban national poverty threshold by state as the budget standard." ///
>  "       The affordable_2 and affordable_3 are estimated utilizing the similar approach but with the double and triple poverty thresholds."
) required
r(100);

end of do-file

r(100);

. do "C:\Users\wb500886\AppData\Local\Temp\STD3140_000000.tmp"

. esttab total q1 q2 q3 q4 q5, cells(mean(fmt(%15.0fc))) label collabels(none) ///
>  mtitles("All" "Q1" "Q2" "Q3" "Q4" "Q5") stats(N, label("Observations") fmt(%15.0gc)) /// 
>  title("Table 1. Share of Households Living in Affordable Houses by Consumption Expenditure Quintile in Urban India (2012)") varwidth(40) ///
>  addnote("Notes: Households weighted by survey weights." ///
>  "       The analysis is using the Residual Income Approach." ///
>  "       The affordable_1 is estimated using renters' non-housing expenses drawn from India's urban national poverty threshold by state as the budget standard." ///
>  "       The affordable_2 and affordable_3 are estimated utilizing the similar approach but with the double and triple poverty thresholds." ///
>  "       Renters are identified as households paying positive rent." )

Table 1. Share of Households Living in Affordable Houses by Consumption Expenditure Quintile in Urban India (2012)
----------------------------------------------------------------------------------------------------------------------
                                                  (1)          (2)          (3)          (4)          (5)          (6)
                                                  All           Q1           Q2           Q3           Q4           Q5
----------------------------------------------------------------------------------------------------------------------
affordable_1                                       92           63           99          100          100          100
affordable_2                                       54            0            7           66           97          100
affordable_3                                       29            0            0            1           48           97
----------------------------------------------------------------------------------------------------------------------
Observations                                   19,132        4,399        3,610        3,604        3,858        3,661
----------------------------------------------------------------------------------------------------------------------
Notes: Households weighted by survey weights.
       The analysis is using the Residual Income Approach.
       The affordable_1 is estimated using renters' non-housing expenses drawn from India's urban national poverty threshold by state as the budget standard.
       The affordable_2 and affordable_3 are estimated utilizing the similar approach but with the double and triple poverty thresholds.
       Renters are identified as households paying positive rent.

. 
end of do-file

. do "C:\Users\wb500886\AppData\Local\Temp\STD3140_000000.tmp"

. esttab total q1 q2 q3 q4 q5, cells(mean(fmt(%15.0fc))) label collabels(none) ///
>  mtitles("All" "Q1" "Q2" "Q3" "Q4" "Q5") stats(N, label("Observations") fmt(%15.0gc)) /// 
>  title("Table 1. Share of Households Living in Affordable Houses by Consumption Expenditure Quintile in Urban India (2012)") varwidth(40) ///
>  addnote("Notes: Households weighted by survey weights." ///
>  "       The analysis is using the Residual Income Approach." ///
>  "       The affordable_1 is estimated using renters' non-housing expenses drawn from India's urban national poverty threshold by state as the budget standard." ///
>  "       The affordable_2 and affordable_3 are estimated utilizing the similar approach but with the double and triple poverty thresholds." ///
>  "       Renters are identified as households paying positive rent." )

Table 1. Share of Households Living in Affordable Houses by Consumption Expenditure Quintile in Urban India (2012)
----------------------------------------------------------------------------------------------------------------------
                                                  (1)          (2)          (3)          (4)          (5)          (6)
                                                  All           Q1           Q2           Q3           Q4           Q5
----------------------------------------------------------------------------------------------------------------------
affordable_1                                       92           63           99          100          100          100
affordable_2                                       54            0            7           66           97          100
affordable_3                                       29            0            0            1           48           97
----------------------------------------------------------------------------------------------------------------------
Observations                                   19,132        4,399        3,610        3,604        3,858        3,661
----------------------------------------------------------------------------------------------------------------------
Notes: Households weighted by survey weights.
       The analysis is using the Residual Income Approach.
       The affordable_1 is estimated using renters' non-housing expenses drawn from India's urban national poverty threshold by state as the budget standard.
       The affordable_2 and affordable_3 are estimated utilizing the similar approach but with the double and triple poverty thresholds.
       Renters are identified as households paying positive rent.

. 
. table mpce_qt [aw = hhwt],c(mean affordable_1 mean affordable_2 mean affordable_3)

----------------------------------------------------------
5         |
quantiles |
of        |
mpce_mrp  | mean(afford~1)  mean(afford~2)  mean(afford~3)
----------+-----------------------------------------------
        1 |       63.02377               0               0
        2 |       98.93314        7.180593               0
        3 |        99.9446        66.48373        .8231241
        4 |       99.93495        97.38465        47.61068
        5 |       99.93237        99.97095        96.70959
----------------------------------------------------------

. 
. * distribution of owner and renter consumption expenditure in urban area 
. gen mpce_mrp_ln = ln(mpce_mrp)

. twoway kdensity mpce_mrp_ln [aw = hhwt] if total_rent > 0 & !mi(total_rent) || kdensity mpce_mrp_ln [aw = hhwt] if (total_rent == 0 | mi(total_rent)), ///
> legend(order(1 "Owner" 2 "Renter")) title("Table 2. Kdensity of Log Monthly per capita Consumer Expenditure (MPCE) for India Urban Household (2012)", size(tiny)) xtitle("Log MPCE") ytitle("Kdensity")

.  
. 
end of do-file

. do "C:\Users\wb500886\AppData\Local\Temp\STD3140_000000.tmp"

. * Version 1.0
. * Last Editor: Aline 
. ****************************************************************************
. 
. ****************************************************************************
. clear 

. clear matrix

. ****************************************************************************
. 
. ****************************************************************************
. * Determine Whose Machine is running the code and set the global directory
. ****************************************************************************
. if "`c(username)'" == "wb308830" local pc = 0

. if "`c(username)'" != "wb308830" local pc = 1

. if `pc' == 0 global root "C:\Users\wb308830\OneDrive - WBG\Documents\TN\Data\NSS 65\" //please correct accordingly

. if `pc' != 0 global root "C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\"

. if `pc' != 0 global script "C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\Housing_git\nss\Survey_NSS\housing_condition"

. 
. di "$root"
C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\

. global r_input "${root}\Raw Data & Dictionaries"

. di "${r_input}"
C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\\Raw Data & Dictionaries

. global r_output "${root}\Data Output Files"

. 
. *Define the survey rounds. 
. global nss_round "NSS49 NSS58 NSS65 NSS69 NSS76" 

. 
end of do-file

. do "C:\Users\wb500886\AppData\Local\Temp\STD3140_000000.tmp"

. use "${root}\NSS49\Data Output Files\NSS49_housing_condition.dta",clear

. 
. foreach survey in NSS58 NSS65 NSS69 NSS76 {
  2. append using "${root}/`survey'/Data Output Files/`survey'_housing_condition.dta",force
  3. }
(note: variable B3_q2 was byte in the using data, but will be str2 now)
(note: variable B3_q5 was str1 in the using data, but will be byte now)
(note: variable B3_q6 was double in the using data, but will be str1 now)
(note: variable B3_q10 was int in the using data, but will be str1 now)
(note: variable B3_q11 was int in the using data, but will be str1 now)
(note: variable B3_q12 was str1 in the using data, but will be byte now)
(note: variable B3_q7 was str1, now str5 to accommodate using data's values)
(note: variable B3_q8 was str1, now str3 to accommodate using data's values)
(note: variable B6_q3 was byte, now int to accommodate using data's values)
(note: variable B6_q4 was int, now long to accommodate using data's values)
(note: variable B6_q6 was byte, now long to accommodate using data's values)
(note: variable B6_q13 was byte, now int to accommodate using data's values)
(note: variable B6_q14 was byte, now int to accommodate using data's values)
(note: variable B6_q15 was byte, now int to accommodate using data's values)
(label hh_urbanl already defined)
(label hh_tnl already defined)
(note: variable B3_q2 was byte in the using data, but will be str2 now)
(note: variable B3_q5 was str5 in the using data, but will be byte now)
(note: variable B3_q12 was str1 in the using data, but will be byte now)
(note: variable B3_q14 was long in the using data, but will be str1 now)
(note: variable B3_q15 was int in the using data, but will be str2 now)
(note: variable B3_q16 was int in the using data, but will be str1 now)
(note: variable B4_q5 was byte in the using data, but will be str1 now)
(note: variable B3_q6 was str1, now str3 to accommodate using data's values)
(note: variable B3_q10 was str1, now str2 to accommodate using data's values)
(note: variable B3_q17 was byte, now long to accommodate using data's values)
(note: variable B3_q18 was byte, now int to accommodate using data's values)
(note: variable B6_q5 was byte, now int to accommodate using data's values)
(note: variable B6_q7 was byte, now int to accommodate using data's values)
(note: variable B6_q8 was byte, now int to accommodate using data's values)
(note: variable B6_q17 was byte, now int to accommodate using data's values)
(label hh_urbanl already defined)
(label hh_tnl already defined)
(label hh_tnl already defined)
(label hh_urbanl already defined)
(note: variable id was str16, now str29 to accommodate using data's values)
(note: variable hh_weight was float, now double to accommodate using data's values)
(label water already defined)
(label hh_urbanl already defined)
(label hh_tnl already defined)

. 
. drop h20_temp h20_distance h20_exclusive h20b_pip_exl h20b_pip_shr h20b_grd_exl h20b_grd_shr h20b_other h20_cooking ///
> san_source san_distance

. 
end of do-file

. help xtile

. mdesc hh_umce

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
        hh_umce |       1,936        573,207           0.34
----------------+-----------------------------------------------

. bysort survey: mdesc hh_umce

-----------------------------------------------------------------------------------------------------------------------------------------------------
-> survey = NSS49

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
        hh_umce |           0        119,421           0.00
----------------+-----------------------------------------------

-----------------------------------------------------------------------------------------------------------------------------------------------------
-> survey = NSS58

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
        hh_umce |         383         97,882           0.39
----------------+-----------------------------------------------

-----------------------------------------------------------------------------------------------------------------------------------------------------
-> survey = NSS65

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
        hh_umce |           0        153,518           0.00
----------------+-----------------------------------------------

-----------------------------------------------------------------------------------------------------------------------------------------------------
-> survey = NSS69

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
        hh_umce |           2         95,548           0.00
----------------+-----------------------------------------------

-----------------------------------------------------------------------------------------------------------------------------------------------------
-> survey = NSS76

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
        hh_umce |       1,551        106,838           1.45
----------------+-----------------------------------------------

. do "C:\Users\wb500886\AppData\Local\Temp\STD3140_000000.tmp"

. clear 

. clear matrix

. ****************************************************************************
. 
. ****************************************************************************
. * Determine Whose Machine is running the code and set the global directory
. ****************************************************************************
. if "`c(username)'" == "wb308830" local pc = 0

. if "`c(username)'" != "wb308830" local pc = 1

. if `pc' == 0 global root "C:\Users\wb308830\OneDrive - WBG\Documents\TN\Data\NSS 76\"

. if `pc' != 0 global root "C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\NSS76"

. if `pc' != 0 global script "C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\Housing_git\nss\Survey_NSS"

. 
. di "$root"
C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\NSS76

. global r_input "${root}\Raw Data & Dictionaries"

. di "${r_input}"
C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\NSS76\Raw Data & Dictionaries

. global r_output "${root}\Data Output Files"

. 
. 
. ****************************************************************************
. * Load the data
. ****************************************************************************
. use "${root}\Data Output Files\NSS76_All.dta"

. 
end of do-file

. mdesc hh_umce

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
        hh_umce |       1,551        106,838           1.45
----------------+-----------------------------------------------

. do "C:\Users\wb500886\AppData\Local\Temp\STD3140_000000.tmp"

. xtile qt = hh_umce,nq(5) by survey
option by not allowed
r(198);

end of do-file

r(198);

. do "C:\Users\wb500886\AppData\Local\Temp\STD3140_000000.tmp"

. if "`c(username)'" == "wb308830" local pc = 0

. if "`c(username)'" != "wb308830" local pc = 1

. if `pc' == 0 global root "C:\Users\wb308830\OneDrive - WBG\Documents\TN\Data\NSS 65\" //please correct accordingly

. if `pc' != 0 global root "C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\"

. if `pc' != 0 global script "C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\Housing_git\nss\Survey_NSS\housing_condition"

. 
. di "$root"
C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\

. global r_input "${root}\Raw Data & Dictionaries"

. di "${r_input}"
C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\\Raw Data & Dictionaries

. global r_output "${root}\Data Output Files"

. 
. *Define the survey rounds. 
. global nss_round "NSS49 NSS58 NSS65 NSS69 NSS76" 

. 
end of do-file

. do "C:\Users\wb500886\AppData\Local\Temp\STD3140_000000.tmp"

. use "${root}\NSS49\Data Output Files\NSS49_housing_condition.dta",clear

. 
. foreach survey in NSS58 NSS65 NSS69 NSS76 {
  2. append using "${root}/`survey'/Data Output Files/`survey'_housing_condition.dta",force
  3. }
(note: variable B3_q2 was byte in the using data, but will be str2 now)
(note: variable B3_q5 was str1 in the using data, but will be byte now)
(note: variable B3_q6 was double in the using data, but will be str1 now)
(note: variable B3_q10 was int in the using data, but will be str1 now)
(note: variable B3_q11 was int in the using data, but will be str1 now)
(note: variable B3_q12 was str1 in the using data, but will be byte now)
(note: variable B3_q7 was str1, now str5 to accommodate using data's values)
(note: variable B3_q8 was str1, now str3 to accommodate using data's values)
(note: variable B6_q3 was byte, now int to accommodate using data's values)
(note: variable B6_q4 was int, now long to accommodate using data's values)
(note: variable B6_q6 was byte, now long to accommodate using data's values)
(note: variable B6_q13 was byte, now int to accommodate using data's values)
(note: variable B6_q14 was byte, now int to accommodate using data's values)
(note: variable B6_q15 was byte, now int to accommodate using data's values)
(label hh_urbanl already defined)
(label hh_tnl already defined)
(note: variable B3_q2 was byte in the using data, but will be str2 now)
(note: variable B3_q5 was str5 in the using data, but will be byte now)
(note: variable B3_q12 was str1 in the using data, but will be byte now)
(note: variable B3_q14 was long in the using data, but will be str1 now)
(note: variable B3_q15 was int in the using data, but will be str2 now)
(note: variable B3_q16 was int in the using data, but will be str1 now)
(note: variable B4_q5 was byte in the using data, but will be str1 now)
(note: variable B3_q6 was str1, now str3 to accommodate using data's values)
(note: variable B3_q10 was str1, now str2 to accommodate using data's values)
(note: variable B3_q17 was byte, now long to accommodate using data's values)
(note: variable B3_q18 was byte, now int to accommodate using data's values)
(note: variable B6_q5 was byte, now int to accommodate using data's values)
(note: variable B6_q7 was byte, now int to accommodate using data's values)
(note: variable B6_q8 was byte, now int to accommodate using data's values)
(note: variable B6_q17 was byte, now int to accommodate using data's values)
(label hh_urbanl already defined)
(label hh_tnl already defined)
(label hh_tnl already defined)
(label hh_urbanl already defined)
(note: variable id was str16, now str29 to accommodate using data's values)
(note: variable hh_weight was float, now double to accommodate using data's values)
(label water already defined)
(label hh_urbanl already defined)
(label hh_tnl already defined)

. 
. drop h20_temp h20_distance h20_exclusive h20b_pip_exl h20b_pip_shr h20b_grd_exl h20b_grd_shr h20b_other h20_cooking ///
> san_source san_distance

. 
end of do-file

. do "C:\Users\wb500886\AppData\Local\Temp\STD3140_000000.tmp"

. egen quant=xtile(hh_umce), n(5) by(survey)
unknown egen function xtile()
r(133);

end of do-file

r(133);

. do "C:\Users\wb500886\AppData\Local\Temp\STD3140_000000.tmp"

. scc install egenmore
command scc is unrecognized
r(199);

end of do-file

r(199);

. do "C:\Users\wb500886\AppData\Local\Temp\STD3140_000000.tmp"

. foreach survey in $nss_round {
  2. qui eststo `survey': quietly estpost summarize `var_summary'  [aw=hh_weight] if survey == "`survey'"
  3. qui eststo `survey'_u: quietly estpost summarize `var_summary'  [aw=hh_weight] if survey == "`survey'" & hh_urban == 1
  4. qui eststo `survey'_r: quietly estpost summarize `var_summary'  [aw=hh_weight] if survey == "`survey'" & hh_urban == 0
  5. }
--Break--
r(1);

end of do-file

--Break--
r(1);

. do "C:\Users\wb500886\AppData\Local\Temp\STD3140_000000.tmp"

. use "${root}\NSS49\Data Output Files\NSS49_housing_condition.dta",clear

. 
. foreach survey in NSS58 NSS65 NSS69 NSS76 {
  2. append using "${root}/`survey'/Data Output Files/`survey'_housing_condition.dta",force
  3. }
(note: variable B3_q2 was byte in the using data, but will be str2 now)
(note: variable B3_q5 was str1 in the using data, but will be byte now)
(note: variable B3_q6 was double in the using data, but will be str1 now)
(note: variable B3_q10 was int in the using data, but will be str1 now)
(note: variable B3_q11 was int in the using data, but will be str1 now)
(note: variable B3_q12 was str1 in the using data, but will be byte now)
(note: variable B3_q7 was str1, now str5 to accommodate using data's values)
(note: variable B3_q8 was str1, now str3 to accommodate using data's values)
(note: variable B6_q3 was byte, now int to accommodate using data's values)
(note: variable B6_q4 was int, now long to accommodate using data's values)
(note: variable B6_q6 was byte, now long to accommodate using data's values)
(note: variable B6_q13 was byte, now int to accommodate using data's values)
(note: variable B6_q14 was byte, now int to accommodate using data's values)
(note: variable B6_q15 was byte, now int to accommodate using data's values)
(label hh_urbanl already defined)
(label hh_tnl already defined)
(note: variable B3_q2 was byte in the using data, but will be str2 now)
(note: variable B3_q5 was str5 in the using data, but will be byte now)
(note: variable B3_q12 was str1 in the using data, but will be byte now)
(note: variable B3_q14 was long in the using data, but will be str1 now)
(note: variable B3_q15 was int in the using data, but will be str2 now)
(note: variable B3_q16 was int in the using data, but will be str1 now)
(note: variable B4_q5 was byte in the using data, but will be str1 now)
(note: variable B3_q6 was str1, now str3 to accommodate using data's values)
(note: variable B3_q10 was str1, now str2 to accommodate using data's values)
(note: variable B3_q17 was byte, now long to accommodate using data's values)
(note: variable B3_q18 was byte, now int to accommodate using data's values)
(note: variable B6_q5 was byte, now int to accommodate using data's values)
(note: variable B6_q7 was byte, now int to accommodate using data's values)
(note: variable B6_q8 was byte, now int to accommodate using data's values)
(note: variable B6_q17 was byte, now int to accommodate using data's values)
(label hh_urbanl already defined)
(label hh_tnl already defined)
(label hh_tnl already defined)
(label hh_urbanl already defined)
(note: variable id was str16, now str29 to accommodate using data's values)
(note: variable hh_weight was float, now double to accommodate using data's values)
(label water already defined)
(label hh_urbanl already defined)
(label hh_tnl already defined)

. 
. drop h20_temp h20_distance h20_exclusive h20b_pip_exl h20b_pip_shr h20b_grd_exl h20b_grd_shr h20b_other h20_cooking ///
> san_source san_distance

. 
end of do-file

. do "C:\Users\wb500886\AppData\Local\Temp\STD3140_000000.tmp"

. ssc install egenmore
checking egenmore consistency and verifying not already installed...
installing into c:\ado\plus\...
installation complete.

. ce), n(5) by(survey)
command ce is unrecognized
r(199);

end of do-file

r(199);

. do "C:\Users\wb500886\AppData\Local\Temp\STD3140_000000.tmp"

. egen quant=xtile(hh_umce), n(5) by(survey)
(1936 missing values generated)

. 
end of do-file

. tab quant

      quant |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |    122,481       21.44       21.44
          2 |    120,693       21.13       42.57
          3 |    109,045       19.09       61.66
          4 |    112,243       19.65       81.30
          5 |    106,809       18.70      100.00
------------+-----------------------------------
      Total |    571,271      100.00

. do "C:\Users\wb500886\AppData\Local\Temp\STD3140_000000.tmp"

. ****************************************************************************
. * Description: Generate table for housing condition for all nss
. * Date: Nov. 25, 2020
. * Version 1.0
. * Last Editor: Aline 
. ****************************************************************************
. 
. ****************************************************************************
. clear 

. clear matrix

. ****************************************************************************
. 
. ****************************************************************************
. * Determine Whose Machine is running the code and set the global directory
. ****************************************************************************
. if "`c(username)'" == "wb308830" local pc = 0

. if "`c(username)'" != "wb308830" local pc = 1

. if `pc' == 0 global root "C:\Users\wb308830\OneDrive - WBG\Documents\TN\Data\NSS 65\" //please correct accordingly

. if `pc' != 0 global root "C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\"

. if `pc' != 0 global script "C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\Housing_git\nss\Survey_NSS\housing_condition"

. 
. di "$root"
C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\

. global r_input "${root}\Raw Data & Dictionaries"

. di "${r_input}"
C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\\Raw Data & Dictionaries

. global r_output "${root}\Data Output Files"

. 
. *Define the survey rounds. 
. global nss_round "NSS49 NSS58 NSS65 NSS69 NSS76" 

. 
. log using "${script}\NSS_table_housing_condition.log",replace
log file already open
r(604);

end of do-file

r(604);

. log close
      name:  <unnamed>
       log:  C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\Housing_git\nss\Survey_NSS\NSS68\02_NSS68_Residual_Income_Affordability.log
  log type:  text
 closed on:   9 Dec 2020, 08:50:55
-----------------------------------------------------------------------------------------------------------------------------------------------------
