---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\Housing_git\nss\Survey_NSS\NSS70\03_NSS70_Table of Means.log
  log type:  text
 opened on:  20 Nov 2020, 04:23:45

. set linesize 255

. ****************************************************************************
. * Summary table for asset and liability: Table 0
. ****************************************************************************
. use "${root}\Data Output Files\NSS70_All.dta",clear

. 
. *whether the households have asset of debt
. gen asset_dm = (asset > 0)*100

. gen debt_dm = (total_debt > 0)*100 

. 
. *narrow the scope to households with positive debt/asset 
. gen asset_pos =  asset if asset > 0
(1,198 missing values generated)

. gen total_debt_pos = total_debt if total_debt > 0
(65,549 missing values generated)

. 
. *home ownership
. gen own_home = (building_dwelling > 0)*100

. 
. *urban hosuehold unit
. replace urban = urban*100
(48,665 real changes made)

. 
. /*
> Quantile of wealth
> Asset: Real Estate, Total Asset
> Liability: Mortgage, Total Liabilities
> */
. 
. global var_tab "asset asset_pos asset_dm total_debt total_debt_pos debt_dm own_home urban hhsize head_female head_age"

. //mdesc $var_tab
. 
. table qtl [aw = hhwgt], c(med wealth) format(%15.0fc)

---------------------------
5         |
quantiles |
of wealth |     med(wealth)
----------+----------------
        1 |          31,050
        2 |         183,000
        3 |         436,500
        4 |         953,450
        5 |       3,049,504
---------------------------

. 
. //not restrcting the sample to positive asset or liability.
. 
. qui eststo total : estpost summarize $var_tab [aw = hhwgt] ,de

. forvalues i = 1/5 {
  2. qui eststo q`i' : estpost summarize $var_tab [aw = hhwgt] if qtl == `i',de
  3. }

. 
. label var asset "Average HH. Assets"

. label var asset_pos "Average Assets for HHs. Owning Assets"

. 
. label var total_debt "Average HH. Debt"

. label var total_debt_pos "Average Debt for Indebted HHs."

. 
. label var asset_dm "Own Asset (%)"

. label var debt_dm "In Debt (%)"

. 
. label var own_home "Dwelling Ownership (%)"

. 
. label var urban "Urban Household (%)"

. label var hhsize "Household Size"

. label var head_age "Household Head Age"

. label var head_female "Female Household Head (%)"

. 
. *household feature
. esttab total q1 q2 q3 q4 q5, cells(mean(fmt(%15.0fc))) label collabels(none) varwidth(40) ///
>  mtitles("All" "Q1" "Q2" "Q3" "Q4" "Q5") stats(N, label("Observations") fmt(%15.0gc)) ///
>  title("Table 0.1 Summary Statistics of Assets and Liabilities by Wealth Quintile (mean)") ///
>  addnotes("Notes: Wealth is defined as total assests net total debt." ///
>           "       HHs. with asset on residential building that used as dwelling is defined as owning dwelling")

Table 0.1 Summary Statistics of Assets and Liabilities by Wealth Quintile (mean)
----------------------------------------------------------------------------------------------------------------------
                                                  (1)          (2)          (3)          (4)          (5)          (6)
                                                  All           Q1           Q2           Q3           Q4           Q5
----------------------------------------------------------------------------------------------------------------------
Average HH. Assets                          1,500,276       65,721      203,237      469,666    1,043,375    5,720,419
Average Assets for HHs. Owning Assets       1,534,103       73,861      203,237      469,666    1,043,375    5,720,419
Own Asset (%)                                      98           89          100          100          100          100
Average HH. Debt                               49,879       44,889       15,400       22,172       43,782      123,169
Average Debt for Indebted HHs.                179,990      201,538       60,585       80,078      140,310      385,122
In Debt (%)                                        28           22           25           28           31           32
Dwelling Ownership (%)                             81           41           88           90           93           93
Urban Household (%)                                35           45           19           25           33           52
Household Size                                      4            3            4            5            5            5
Female Household Head (%)                          14           20           15           13           12           10
Household Head Age                                 46           38           45           46           49           52
----------------------------------------------------------------------------------------------------------------------
Observations                                  110,800       17,520       20,700       22,102       24,049       26,429
----------------------------------------------------------------------------------------------------------------------
Notes: Wealth is defined as total assests net total debt.
       HHs. with asset on residential building that used as dwelling is defined as owning dwelling

. 
. esttab total q1 q2 q3 q4 q5, cells(p50(fmt(%15.0fc))) label collabels(none) varwidth(40) ///
>  mtitles("All" "Q1" "Q2" "Q3" "Q4" "Q5") stats(N, label("Observations") fmt(%15.0gc)) ///
>  title("Table 0.2 Summary Statistics of Assets and Liabilities by Wealth Quintile (med)") ///
>  addnotes("Notes: Wealth is defined as total assests net total debt." ///
>           "       HHs. with asset on residential building that used as dwelling is defined as owning dwelling")

Table 0.2 Summary Statistics of Assets and Liabilities by Wealth Quintile (med)
----------------------------------------------------------------------------------------------------------------------
                                                  (1)          (2)          (3)          (4)          (5)          (6)
                                                  All           Q1           Q2           Q3           Q4           Q5
----------------------------------------------------------------------------------------------------------------------
Average HH. Assets                            459,330       43,250      195,000      452,400      989,000    3,164,190
Average Assets for HHs. Owning Assets         478,150       50,000      195,000      452,400      989,000    3,164,190
Own Asset (%)                                     100          100          100          100          100          100
Average HH. Debt                                    0            0            0            0            0            0
Average Debt for Indebted HHs.                 52,000       49,375       26,750       36,000       55,000      150,000
In Debt (%)                                         0            0            0            0            0            0
Dwelling Ownership (%)                            100            0          100          100          100          100
Urban Household (%)                                 0            0            0            0            0          100
Household Size                                      4            3            4            4            5            5
Female Household Head (%)                           0            0            0            0            0            0
Household Head Age                                 45           35           42           45           48           51
----------------------------------------------------------------------------------------------------------------------
Observations                                  110,800       17,520       20,700       22,102       24,049       26,429
----------------------------------------------------------------------------------------------------------------------
Notes: Wealth is defined as total assests net total debt.
       HHs. with asset on residential building that used as dwelling is defined as owning dwelling

.  
. ****************************************************************************
. * Housing mortgage loan features
. ****************************************************************************
. use "${r_input}\Visit 1_Block 14",clear

. drop if b14_q1 == "99" //drop the total amount
(73,266 observations deleted)

. 
. *debt, borrowed amount, repay amount.
. gen debt = b14_q17 //outstanding amout at end of June 2012
(47,671 missing values generated)

. gen debt_todt = b14_q16 //outstanding amout at the date of survey
(1,688 missing values generated)

. gen borrow = b14_q5 //original borrowed amount
(1 missing value generated)

. gen repay = b14_q14 //amount (`) repaid (including interest) during 01.07.2012 to date of survey
(43,996 missing values generated)

. 
. *** Two housing mortgage definitions 
. //tab b14_q12
. gen secure_type = b14_q12
(6 missing values generated)

. 
. //tab b14_q11
. gen loan_purpose = b14_q11
(4 missing values generated)

. 
. * (A) Conservative (label 1)housing loan with immovable property as secure type: B14_Q11 == 11 & (B14_Q12 == 3 | B14_Q12 == 4)
. gen mrtg_1_dm = (loan_purpose == "11" & (secure_type == "04"|secure_type == "03"))

. 
. * (B) Less conservative (let's label 2) housing loan with mortgage: B14_Q11 == 11 & B14_13 != 4
. gen mrtg_2_dm = (loan_purpose == "11" & (b14_q13 != "4"& b14_q13 != ""))

. 
. *** Housing mortgage features 
. 
. *aggregate at household level. 
. egen double debt_total = sum(debt),by(HHID)

. egen double borrow_total = sum(borrow),by(HHID)

. 
. *** Other laon features
. //tab b14_q3 [aw = Weight_SS]
. //tab b14_q2 [aw = Weight_SS]
. 
. *interest rate and type
. gen intst_rate = b14_q10/100/12
(539 missing values generated)

. gen intst_type = b14_q9
(34 missing values generated)

. sum intst_rate [aw = Weight_SS],de

                         intst_rate
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            0              0
10%            0              0       Obs             109,904
25%         .005              0       Sum of Wgt.   349416471

50%          .01                      Mean           .0152051
                        Largest       Std. Dev.      .0195639
75%          .02             .2
90%          .03             .2       Variance       .0003827
95%          .05              1       Skewness       71.32512
99%           .1            4.5       Kurtosis       16004.17

. replace intst_rate  = . if intst_rate > r(p95)
(1,481 real changes made, 1,481 to missing)

. 
. *loan borrowing date. 
. gen month = real(b14_q2)
(10 missing values generated)

. gen year = b14_q3
(4 missing values generated)

. 
. gen date_loan = ym(year,month)
(10 missing values generated)

. format date_loan %tmMCY

. 
. merge m:1 HHID using "${root}\Data Output Files\NSS70_All.dta"

    Result                           # of obs.
    -----------------------------------------
    not matched                        37,081
        from master                         0  (_merge==1)
        from using                     37,081  (_merge==2)

    matched                           110,443  (_merge==3)
    -----------------------------------------

. 
. gen loan_age = date_survey - date_loan //laon from borrow to date of survey, in month.
(37,091 missing values generated)

. replace loan_age = . if loan_age < 0 
(198 real changes made, 198 to missing)

. 
. sum loan_age [aw = Weight_SS],de

                          loan_age
-------------------------------------------------------------
      Percentiles      Smallest
 1%            0              0
 5%            1              0
10%            2              0       Obs             110,235
25%            5              0       Sum of Wgt.   350170108

50%           11                      Mean           18.56219
                        Largest       Std. Dev.      24.56695
75%           23            421
90%           44            457       Variance       603.5353
95%           63            476       Skewness        3.76297
99%          123            491       Kurtosis       25.40451

. replace loan_age  = . if loan_age > r(p99)
(1,477 real changes made, 1,477 to missing)

. 
. *houseing mortgage amount
. foreach var in debt debt_todt borrow {
  2.   replace `var' = 0 if mi(`var')
  3. }
(84,752 real changes made)
(38,769 real changes made)
(37,082 real changes made)

. 
. forvalues i = 1/2 {
  2.   foreach var in debt debt_todt borrow repay{
  3.   replace mrtg_`i'_dm = 0 if mi(mrtg_`i'_dm)
  4.   gen mrtg_`i'_`var' = mrtg_`i'_dm*`var'
  5.   }
  6. }
(37,081 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(81,077 missing values generated)
(37,081 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(81,077 missing values generated)

. 
. //mdesc mrtg_*
. 
. *household feature
. replace urban = urban*100 
(64,079 real changes made)

. 
. *monthly payment. 
. gen date_temp = ym(2012,7)

. gen repay_mt = date_survey - date_temp //01.07.2012 to date of survey

. 
. drop date_temp

. //tab repay_mt 
. 
. forvalues i=1/2  {
  2. gen double repay_mt_`i' = mrtg_`i'_repay/repay_mt //monthly payment calculation
  3. }
(81,077 missing values generated)
(81,077 missing values generated)

. 
. forvalues i = 1/2 {
  2. mdesc repay_mt_`i' repay_mt mrtg_`i'_repay //check missing values. 54% on repay information
  3. }

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     repay_mt_1 |      81,077        147,524          54.96
       repay_mt |           0        147,524           0.00
   mrtg_1_repay |      81,077        147,524          54.96
----------------+-----------------------------------------------

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     repay_mt_2 |      81,077        147,524          54.96
       repay_mt |           0        147,524           0.00
   mrtg_2_repay |      81,077        147,524          54.96
----------------+-----------------------------------------------

. 
. *loan period estimation 
. forvalues i = 1/2 {
  2. gen double loan_period_`i'= - ln(1 - mrtg_`i'_borrow *intst_rate * (1/repay_mt_`i')) / ln(1+ intst_rate)
  3. sum loan_period_`i' [aw = Weight_SS],de
  4. replace loan_period_`i' = . if loan_period_`i' > r(p99) //exclude the ourliers 
  5. }
(144,269 missing values generated)

                        loan_period_1
-------------------------------------------------------------
      Percentiles      Smallest
 1%      7.53366       2.339866
 5%     15.58093       2.729418
10%     26.20565       3.229259       Obs               3,255
25%     53.33976        3.26585       Sum of Wgt.   8,081,192

50%     102.8545                      Mean           163.7759
                        Largest       Std. Dev.      272.9406
75%     179.0596       2307.234
90%     264.3022       3532.073       Variance       74496.56
95%      371.063       3532.073       Skewness        5.84224
99%      1770.43       3813.385       Kurtosis       46.18742
(11 real changes made, 11 to missing)
(143,571 missing values generated)

                        loan_period_2
-------------------------------------------------------------
      Percentiles      Smallest
 1%      6.69942       2.339866
 5%     11.78581       2.729418
10%     22.08141       3.050778       Obs               3,953
25%     48.85596       3.229259       Sum of Wgt.   9,947,052

50%     97.10983                      Mean           170.1287
                        Largest       Std. Dev.      296.2969
75%     174.4078       2357.645
90%     272.3213       3532.073       Variance       87791.83
95%     450.2782       3532.073       Skewness       5.077065
99%      1770.43       3813.385       Kurtosis       34.51334
(17 real changes made, 17 to missing)

. 
. sum loan_period_*

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
loan_perio~1 |      3,244    145.3515    193.6086   2.339866    1770.43
loan_perio~2 |      3,936    145.2648    212.1959   2.339866    1770.43

. 
. forvalues i = 1/2 {
  2. mdesc loan_period_`i' mrtg_`i'_borrow intst_rate repay_mt_`i' if mrtg_`i'_borrow > 0  //check missing value: 97% loan period missing. 
  3. }

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
   loan_perio~1 |       1,699          4,943          34.37
   mrtg_1_bor~w |           0          4,943           0.00
     intst_rate |           6          4,943           0.12
     repay_mt_1 |         632          4,943          12.79
----------------+-----------------------------------------------

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
   loan_perio~2 |       2,977          6,913          43.06
   mrtg_2_bor~w |           0          6,913           0.00
     intst_rate |          11          6,913           0.16
     repay_mt_2 |       1,472          6,913          21.29
----------------+-----------------------------------------------

. 
. 
. *the loan is subsidized 
. gen loan_sub = (b14_q7 != "09")*100 

. 
. *label variables
. label var urban "Urban Household (%)"

. label var hhsize "Household Size"

. label var head_age "Household Head Age"

. label var head_female "Female Household Head (%)"

. label var loan_sub "Subsidized (%)"

. 
. save "${r_output}\b14_hse_mortgage",replace
file C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\nss_data\NSS70\Data Output Files\b14_hse_mortgage.dta saved

. 
. ***********************************************
. ***Table 1. Homewoners
. ***********************************************
. use "${r_output}\b14_hse_mortgage",clear

. 
. //keep if building_dwelling > 0 //only focus on home owner.
. 
. foreach type in mrtg_1_dm mrtg_2_dm mrtg_1_debt mrtg_2_debt mrtg_1_borrow mrtg_2_borrow mrtg_1_repay mrtg_2_repay{ 
  2. egen double total_`type' = sum(`type'), by(HHID)
  3. } 

. 
. bys HHID: keep if _n == 1 // keep only one observation for each HH
(36,724 observations deleted)

. 
. /* Table Content:
> a. Value of Residential Real Estate where HH is Dwelling
> b. Value of Land Associated with #a
> c. Value of Building with #a
> d. Size in square of feet of building of #a
> e. Total assets of these people (median median) //using as quintile. 
> f. Percent of assets of residential RE in total assets 
> g) Who are these people? (i) urban, (ii) hh size, (iii) gender, (iv) age
> h. How many (%) of these had a mortgage (paid off) /Mortgage holders
> */
. 
. *Variables to generate
. replace building_dwelling_area = building_dwelling_area*10.76 //change unit from sq me to sq ft
variable building_dwelling_area was int now float
(91,985 real changes made)

. 
. gen double real_estate_dwelling_share = real_estate_dwelling/asset*100 //f. Percent of assets of residential RE in total assets 
(1,198 missing values generated)

. 
. gen double land_re_share = land_resid/real_estate_dwelling*100 //percent of land to RE value
(17,442 missing values generated)

. 
. gen double dwell_sqft = building_dwelling/building_dwelling_area*100 //value of dwelling per sq.ft
(18,815 missing values generated)

. 
. forvalues i=1/2  {
  2. gen total_mrtg_`i' = (total_mrtg_`i'_dm > 0)*100 //h. How many (%) of these had a mortgage during the survey period. 
  3. }

. 
. *label the key variables //Primary Residential Real Estate 
. label var real_estate_dwelling "Total PRRE Value"

. label var land_resid "Land PRRE Value"

. label var land_re_share "Share of Land PRRE Value in Total PRRE Value (%)"

. label var building_dwelling "Building PRRE Value"

. label var building_dwelling_area "Size of Builing of PREE"

. label var dwell_sqft "PRRE Value in INR / Sq Ft (Sq ft is of building value)"

. label var asset "Total Assets"

. label var real_estate_dwelling_share "PRRE Value in Total Assets (%)"

. label var total_mrtg_1 "Mortgage Holders_1 (%)"

. label var total_mrtg_2 "Mortgage Holders_2 (%)"

. 
. 
. *create the table 
. global var_tab_1 "real_estate_dwelling land_resid land_re_share building_dwelling building_dwelling_area dwell_sqft real_estate_dwelling_share urban hhsize head_female head_age total_mrtg_1 total_mrtg_2"

. 
. gen homeowner = (building_dwelling > 0 )*100

. 
. //mdesc $var_tab_1  //check missing values 
. 
. foreach var in $var_tab_1  {
  2. replace `var' = . if building_dwelling == 0 | mi(building_dwelling) //only focus on home owner.
  3. }
(18,737 real changes made, 18,737 to missing)
(18,737 real changes made, 18,737 to missing)
(1,295 real changes made, 1,295 to missing)
(18,737 real changes made, 18,737 to missing)
(3,425 real changes made, 3,425 to missing)
(14 real changes made, 14 to missing)
(17,539 real changes made, 17,539 to missing)
(18,737 real changes made, 18,737 to missing)
(18,737 real changes made, 18,737 to missing)
(18,737 real changes made, 18,737 to missing)
(18,737 real changes made, 18,737 to missing)
(18,737 real changes made, 18,737 to missing)
(18,737 real changes made, 18,737 to missing)

. 
. mdesc $var_tab_1 //check missing valuee

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
   real_estat~g |      18,737        110,800          16.91
     land_resid |      18,737        110,800          16.91
   land_re_sh~e |      18,737        110,800          16.91
   building_d~g |      18,737        110,800          16.91
   building_d~a |      18,737        110,800          16.91
     dwell_sqft |      18,829        110,800          16.99
   real_esta~re |      18,737        110,800          16.91
          urban |      18,737        110,800          16.91
         hhsize |      18,737        110,800          16.91
    head_female |      18,737        110,800          16.91
       head_age |      18,737        110,800          16.91
   total_mrtg_1 |      18,737        110,800          16.91
   total_mrtg_2 |      18,737        110,800          16.91
----------------+-----------------------------------------------

. 
. gen owner = (building_dwelling > 0 & !mi(building_dwelling))*100

. //tab owner //obvservations with none of the value mssing. 
. label var owner "Home Ownership (%)"

. 
. qui eststo total : estpost summarize $var_tab_1 owner [aw = hhwgt],de

. forvalues i = 1/5 {
  2. qui eststo q`i' : estpost summarize $var_tab_1 owner [aw = hhwgt] if qtl == `i',de
  3. }

. 
. esttab total q1 q2 q3 q4 q5, cells(mean(fmt(%15.0fc))) label collabels(none) ///
>  mtitles("All" "Q1" "Q2" "Q3" "Q4" "Q5") stats(N, label("Observations") fmt(%15.0gc)) /// 
>  title("Table 1.1 Summary Statistics of Homeowners by Wealth Quintile(mean)") varwidth(40) ///
>  addnote("Notes: Households weighted by survey weights." ///
>  "       Homeowners are households own residential building used as dwelling by household members." ///
>  "       Real estate includes dwelling and urban and rural land used as residential area.")

Table 1.1 Summary Statistics of Homeowners by Wealth Quintile(mean)
----------------------------------------------------------------------------------------------------------------------
                                                  (1)          (2)          (3)          (4)          (5)          (6)
                                                  All           Q1           Q2           Q3           Q4           Q5
----------------------------------------------------------------------------------------------------------------------
Total PRRE Value                              889,216       76,635      137,158      262,623      539,234    2,904,116
Land PRRE Value                               349,122       28,805       52,175       99,177      216,955    1,140,934
Share of Land PRRE Value in Total PRRE V           38           38           37           36           37           41
Building PRRE Value                           540,094       47,830       84,983      163,446      322,279    1,763,181
Size of Builing of PREE                           720          371          503          647          786        1,081
PRRE Value in INR / Sq Ft (Sq ft is of b       73,660       16,796       25,087       37,896       68,291      183,970
PRRE Value in Total Assets (%)                     58           77           69           57           52           49
Urban Household (%)                                25            6           11           18           29           50
Household Size                                      5            4            4            5            5            5
Female Household Head (%)                          13           17           16           13           12           10
Household Head Age                                 48           43           45           47           49           52
Mortgage Holders_1 (%)                              3            1            1            1            3            7
Mortgage Holders_2 (%)                              4            2            1            2            4            8
Home Ownership (%)                                 81           41           88           90           93           93
----------------------------------------------------------------------------------------------------------------------
Observations                                  110,800       17,520       20,700       22,102       24,049       26,429
----------------------------------------------------------------------------------------------------------------------
Notes: Households weighted by survey weights.
       Homeowners are households own residential building used as dwelling by household members.
       Real estate includes dwelling and urban and rural land used as residential area.

. 
. esttab total q1 q2 q3 q4 q5, cells(p50(fmt(%15.0fc))) label collabels(none) ///
>  mtitles("All" "Q1" "Q2" "Q3" "Q4" "Q5") stats(N, label("Observations") fmt(%15.0gc)) /// 
>  title("Table 1.2 Summary Statistics of Homeowners by Wealth Quintile (med)") varwidth(40) ///
>  addnote("Notes: Households weighted by survey weights." ///
>  "       Homeowners are households own residential building used as dwelling by household members." ///
>  "       Real estate includes dwelling and urban and rural land used as residential area.")

Table 1.2 Summary Statistics of Homeowners by Wealth Quintile (med)
----------------------------------------------------------------------------------------------------------------------
                                                  (1)          (2)          (3)          (4)          (5)          (6)
                                                  All           Q1           Q2           Q3           Q4           Q5
----------------------------------------------------------------------------------------------------------------------
Total PRRE Value                              250,000       55,000      125,000      245,000      462,192    1,451,790
Land PRRE Value                                70,000       20,000       40,000       60,000      120,000      400,000
Share of Land PRRE Value in Total PRRE V           36           38           35           33           35           40
Building PRRE Value                           150,000       30,000       75,000      150,000      250,000      660,000
Size of Builing of PREE                           538          269          398          495          624          893
PRRE Value in INR / Sq Ft (Sq ft is of b       30,305       10,723       18,967       27,881       41,305       74,349
PRRE Value in Total Assets (%)                     60           83           74           55           46           44
Urban Household (%)                                 0            0            0            0            0            0
Household Size                                      4            4            4            4            5            5
Female Household Head (%)                           0            0            0            0            0            0
Household Head Age                                 46           40           43           45           48           52
Mortgage Holders_1 (%)                              0            0            0            0            0            0
Mortgage Holders_2 (%)                              0            0            0            0            0            0
Home Ownership (%)                                100            0          100          100          100          100
----------------------------------------------------------------------------------------------------------------------
Observations                                  110,800       17,520       20,700       22,102       24,049       26,429
----------------------------------------------------------------------------------------------------------------------
Notes: Households weighted by survey weights.
       Homeowners are households own residential building used as dwelling by household members.
       Real estate includes dwelling and urban and rural land used as residential area.

. 
. 
. ***********************************************
. *** Table 2. Table of Mortgages
. ***********************************************
. use "${r_output}\b14_hse_mortgage",clear

. 
. *all of the mortgages are those active during survey period.
. forvalues i = 1/2 {
  2. egen closed_`i' = rowtotal(mrtg_`i'_debt mrtg_`i'_debt_todt mrtg_`i'_repay)
  3. replace closed_`i' = (closed_`i' == 0)*100 //less than 1 percent loan is paid off. 
  4. sum  closed_`i' if mrtg_`i'_borrow > 0  
  5. drop closed_`i'
  6. }
(147,524 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
    closed_1 |      4,943    .0606919    2.463074          0        100
(147,524 real changes made)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
    closed_2 |      6,913    .1012585    3.180733          0        100

. 
. /*
> a) value of loan taken at inception (mortgage value) - amount borrowed
> b) Term of loan (calculated) 
> c) Interest rate (given)
> d) Monthly payment (calculate)
> e) Is it subsidized (column 7)
> f) count of mortgages - 100? 200? N. Number of observations 
> g) Who are these people? (i) urban, (ii) hh size, (iii) gender, (iv) age
> */
. 
. replace intst_rate = intst_rate*100*12
(84,996 real changes made)

. 
. label var mrtg_1_borrow "Mortgage Value at Inception_1"

. label var mrtg_2_borrow "Mortgage Value at Inception_2"

. label var loan_period_1 "Term of Loan_1 (mt)"

. label var loan_period_2 "Term of Loan_2 (mt)"

. label var intst_rate "Interest rate (%)"

. label var repay_mt_1 "Monthly Payment_1"

. label var repay_mt_2 "Monthly Payment_2"

. 
. *create the table 
. global var_tab_2 "intst_rate loan_sub urban hhsize head_female head_age"

. 
. forvalues x = 1/2 {
  2. mdesc intst_rate mrtg_`x'_borrow loan_period_`x' repay_mt_`x'
  3. }

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     intst_rate |      39,101        147,524          26.50
   mrtg_1_bor~w |           0        147,524           0.00
   loan_perio~1 |     144,280        147,524          97.80
     repay_mt_1 |      81,077        147,524          54.96
----------------+-----------------------------------------------

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     intst_rate |      39,101        147,524          26.50
   mrtg_2_bor~w |           0        147,524           0.00
   loan_perio~2 |     143,588        147,524          97.33
     repay_mt_2 |      81,077        147,524          54.96
----------------+-----------------------------------------------

. 
. forvalues x = 1/2 {
  2. gen double obs_`x' = (intst_rate + loan_sub + urban + hhsize + head_female + head_age + mrtg_`x'_borrow + loan_period_`x' + repay_mt_`x') != . //obsevations will full loan information
  3. mdesc intst_rate loan_sub urban hhsize head_female head_age mrtg_`x'_borrow loan_period_`x' repay_mt_`x' if mrtg_`x'_borrow > 0 & obs_`x' == 1
  4. }

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     intst_rate |           0          3,244           0.00
       loan_sub |           0          3,244           0.00
          urban |           0          3,244           0.00
         hhsize |           0          3,244           0.00
    head_female |           0          3,244           0.00
       head_age |           0          3,244           0.00
   mrtg_1_bor~w |           0          3,244           0.00
   loan_perio~1 |           0          3,244           0.00
     repay_mt_1 |           0          3,244           0.00
----------------+-----------------------------------------------

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     intst_rate |           0          3,936           0.00
       loan_sub |           0          3,936           0.00
          urban |           0          3,936           0.00
         hhsize |           0          3,936           0.00
    head_female |           0          3,936           0.00
       head_age |           0          3,936           0.00
   mrtg_2_bor~w |           0          3,936           0.00
   loan_perio~2 |           0          3,936           0.00
     repay_mt_2 |           0          3,936           0.00
----------------+-----------------------------------------------

. 
. tab year,sort //select the year cut for loan borrow year. 

       year |      Freq.     Percent        Cum.
------------+-----------------------------------
       2012 |     52,728       47.74       47.74
       2013 |     19,469       17.63       65.37
       2011 |     15,457       14.00       79.37
       2010 |      8,853        8.02       87.38
       2009 |      4,492        4.07       91.45
       2008 |      2,967        2.69       94.14
       2007 |      1,793        1.62       95.76
       2006 |      1,181        1.07       96.83
       2005 |        910        0.82       97.66
       2004 |        589        0.53       98.19
       2003 |        523        0.47       98.66
       2002 |        329        0.30       98.96
       2000 |        324        0.29       99.25
       2001 |        237        0.21       99.47
       1998 |        137        0.12       99.59
       1999 |         83        0.08       99.67
       1996 |         56        0.05       99.72
       1997 |         55        0.05       99.77
       1995 |         52        0.05       99.82
       1993 |         46        0.04       99.86
       1992 |         36        0.03       99.89
       1994 |         31        0.03       99.92
       1990 |         25        0.02       99.94
       1989 |         11        0.01       99.95
       1987 |         10        0.01       99.96
       1991 |         10        0.01       99.97
       1988 |          9        0.01       99.98
       1985 |          8        0.01       99.98
       1980 |          4        0.00       99.99
       1984 |          3        0.00       99.99
       1986 |          3        0.00       99.99
       1972 |          1        0.00       99.99
       1973 |          1        0.00       99.99
       1975 |          1        0.00      100.00
       1978 |          1        0.00      100.00
       1979 |          1        0.00      100.00
       1981 |          1        0.00      100.00
       1982 |          1        0.00      100.00
       1983 |          1        0.00      100.00
------------+-----------------------------------
      Total |    110,439      100.00

. 
. forvalues i = 2002(2)2013 {
  2. local j = `i' + 1 
  3. dis `i' "-"`j'
  4.   forvalues x = 1/2 {
  5.   qui eststo total_`x' : estpost summarize mrtg_`x'_borrow loan_period_`x' repay_mt_`x' $var_tab_2 [aw = hhwgt] if mrtg_`x'_borrow > 0 & obs_`x' == 1,de
  6.   qui eststo yr_`j'_`x' : estpost summarize mrtg_`x'_borrow loan_period_`x' repay_mt_`x' $var_tab_2 [aw = hhwgt] if inrange(year,`i',`j') & mrtg_`x'_borrow > 0 & obs_`x' == 1,de
  7.   qui eststo yr_2002_`x' : estpost summarize mrtg_`x'_borrow loan_period_`x' repay_mt_`x' $var_tab_2 [aw = hhwgt] if year<2002 & mrtg_`x'_borrow > 0 & obs_`x' == 1,de
  8.   }
  9. }
2002-2003
2004-2005
2006-2007
2008-2009
2010-2011
2012-2013

. 
. forvalues x = 1/2 {
  2. esttab total_`x' yr_2013_`x' yr_2011_`x' yr_2009_`x' yr_2007_`x' yr_2005_`x' yr_2003_`x' yr_2002_`x', cells(mean(fmt(%15.0fc))) label collabels(none) ///
>  mtitles("All" "2012-2013" "2010-2011" "2008-2009" "2006-2007" "2004-2005" "2002-2003" "<2002") stats(N, label("Observations") fmt(%15.0gc)) ///
>  title("Table 2.1 Summary Statistics of Mortgages (mean)_`x' by Borrowed Year") varwidth(25) ///
>  addnotes("Notes: Households weighted by survey weights."  ///
>           "       The term of loan is imputed by monthly payment, interest rate, and the mortgage value at inception." ///
>                   "       The monthly payment is estimated by the amount repaid divide during 7/1/2012 to date of survey.")
  3. }

Table 2.1 Summary Statistics of Mortgages (mean)_1 by Borrowed Year
---------------------------------------------------------------------------------------------------------------------------------
                                   (1)          (2)          (3)          (4)          (5)          (6)          (7)          (8)
                                   All    2012-2013    2010-2011    2008-2009    2006-2007    2004-2005    2002-2003        <2002
---------------------------------------------------------------------------------------------------------------------------------
Mortgage Value at Incep~1      668,650      426,549      829,603      815,360      766,296      500,311      397,954      322,039
Term of Loan_1 (mt)                157          119          134          223          182          177          171          117
Monthly Payment_1               11,963        7,216       13,581       16,470       12,301       10,195        8,681        8,674
Interest rate (%)                   11           13           12           12           11           10            9           10
Subsidized (%)                      93           89           94           95           94           91          100           99
Urban Household (%)                 71           48           69           76           87           80           92           83
Household Size                       5            4            5            4            5            5            5            5
Female Household Head (%)            8            8            9            7            8            5            2           17
Household Head Age                  49           47           49           50           50           51           51           53
---------------------------------------------------------------------------------------------------------------------------------
Observations                     3,244          585        1,070          538          424          334          146          147
---------------------------------------------------------------------------------------------------------------------------------
Notes: Households weighted by survey weights.
       The term of loan is imputed by monthly payment, interest rate, and the mortgage value at inception.
       The monthly payment is estimated by the amount repaid divide during 7/1/2012 to date of survey.

Table 2.1 Summary Statistics of Mortgages (mean)_2 by Borrowed Year
---------------------------------------------------------------------------------------------------------------------------------
                                   (1)          (2)          (3)          (4)          (5)          (6)          (7)          (8)
                                   All    2012-2013    2010-2011    2008-2009    2006-2007    2004-2005    2002-2003        <2002
---------------------------------------------------------------------------------------------------------------------------------
Mortgage Value at Incep~2      598,155      308,122      757,134      787,946      728,449      494,361      399,063      323,909
Term of Loan_2 (mt)                160          152          135          211          181          173          171          116
Monthly Payment_2               11,076        5,749       12,598       16,153       12,399       10,780        8,589        9,257
Interest rate (%)                   12           14           12           12           11           10            9           10
Subsidized (%)                      91           84           91           93           95           91          100           98
Urban Household (%)                 68           48           67           76           87           81           92           83
Household Size                       4            4            5            4            5            5            5            5
Female Household Head (%)            9           11           10            7            9            5            2           17
Household Head Age                  49           46           48           50           50           51           51           53
---------------------------------------------------------------------------------------------------------------------------------
Observations                     3,936          892        1,300          619          460          355          154          156
---------------------------------------------------------------------------------------------------------------------------------
Notes: Households weighted by survey weights.
       The term of loan is imputed by monthly payment, interest rate, and the mortgage value at inception.
       The monthly payment is estimated by the amount repaid divide during 7/1/2012 to date of survey.

. 
. forvalues x = 1/2 {
  2. esttab total_`x' yr_2013_`x' yr_2011_`x' yr_2009_`x' yr_2007_`x' yr_2005_`x' yr_2003_`x' yr_2002_`x', cells(p50(fmt(%15.0fc))) label collabels(none) ///
>  mtitles("All" "2012-2013" "2010-2011" "2008-2009" "2006-2007" "2004-2005" "2002-2003" "<2002") stats(N, label("Observations") fmt(%15.0gc)) ///
>  title("Table 2.2 Summary Statistics of Mortgages (med)_`x' by Borrowed Year") varwidth(25) ///
>  addnotes("Notes: Households weighted by survey weights." ///
>           "       The term of loan is imputed by monthly payment, interest rate, and the mortgage value at inception." ///
>                   "       The monthly payment is estimated by the amount repaid divide during 7/1/2012 to date of survey.")
  3. }

Table 2.2 Summary Statistics of Mortgages (med)_1 by Borrowed Year
---------------------------------------------------------------------------------------------------------------------------------
                                   (1)          (2)          (3)          (4)          (5)          (6)          (7)          (8)
                                   All    2012-2013    2010-2011    2008-2009    2006-2007    2004-2005    2002-2003        <2002
---------------------------------------------------------------------------------------------------------------------------------
Mortgage Value at Incep~1      400,000      150,000      400,000      500,000      500,000      450,000      210,000      248,000
Term of Loan_1 (mt)                102           71           92          119          132          143          145           96
Monthly Payment_1                6,250        3,200        8,750        7,091        7,636        5,500        3,000        3,988
Interest rate (%)                   11           13           11           12           11           10           10           10
Subsidized (%)                     100          100          100          100          100          100          100          100
Urban Household (%)                100            0          100          100          100          100          100          100
Household Size                       4            4            4            4            4            4            5            4
Female Household Head (%)            0            0            0            0            0            0            0            0
Household Head Age                  48           44           46           48           47           50           50           55
---------------------------------------------------------------------------------------------------------------------------------
Observations                     3,244          585        1,070          538          424          334          146          147
---------------------------------------------------------------------------------------------------------------------------------
Notes: Households weighted by survey weights.
       The term of loan is imputed by monthly payment, interest rate, and the mortgage value at inception.
       The monthly payment is estimated by the amount repaid divide during 7/1/2012 to date of survey.

Table 2.2 Summary Statistics of Mortgages (med)_2 by Borrowed Year
---------------------------------------------------------------------------------------------------------------------------------
                                   (1)          (2)          (3)          (4)          (5)          (6)          (7)          (8)
                                   All    2012-2013    2010-2011    2008-2009    2006-2007    2004-2005    2002-2003        <2002
---------------------------------------------------------------------------------------------------------------------------------
Mortgage Value at Incep~2      300,000      150,000      400,000      450,000      500,000      450,000      250,000      250,000
Term of Loan_2 (mt)                 97           71           87          110          131          143          145           96
Monthly Payment_2                5,556        3,200        7,809        6,500        7,042        5,500        3,000        4,000
Interest rate (%)                   11           13           11           12           11           10           10           10
Subsidized (%)                     100          100          100          100          100          100          100          100
Urban Household (%)                100            0          100          100          100          100          100          100
Household Size                       4            4            4            4            4            4            5            4
Female Household Head (%)            0            0            0            0            0            0            0            0
Household Head Age                  47           44           46           48           48           50           50           55
---------------------------------------------------------------------------------------------------------------------------------
Observations                     3,936          892        1,300          619          460          355          154          156
---------------------------------------------------------------------------------------------------------------------------------
Notes: Households weighted by survey weights.
       The term of loan is imputed by monthly payment, interest rate, and the mortgage value at inception.
       The monthly payment is estimated by the amount repaid divide during 7/1/2012 to date of survey.

. 
. 
. 
. *******************************************************************
. *** Table 3. Table of Mortgages feature by wealth quintile
. *******************************************************************
. /*
> *check the cases where one household have several mortgages. 
> use "${r_output}\b14_hse_mortgage",clear
> 
> forvalues i = 1/2 { 
> egen double mrtg_`i'_n = sum(mrtg_`i'_dm) if mrtg_`i'_borrow > 0, by(HHID)
> } 
> 
> 
> forvalues i = 1/2 { 
> tab mrtg_`i'_n if mrtg_`i'_borrow > 0 //more than 70% only with 1 housing mortgage
> }
> 
> br HHID mrtg_1_borrow if mrtg_1_n > 1 & mrtg_1_borrow  > 0 //there are cases with multiple same amount mortgages.
> */
. 
. *generate the mortgage status by household wealth status. 
. use "${r_output}\b14_hse_mortgage",clear

. 
. label var mrtg_1_borrow "Mortgage Value at Inception_1"

. label var mrtg_2_borrow "Mortgage Value at Inception_2"

. label var loan_period_1 "Term of Loan_1 (mt)"

. label var loan_period_2 "Term of Loan_2 (mt)"

. label var intst_rate "Interest rate (%)"

. label var repay_mt_1 "Monthly Payment_1"

. label var repay_mt_2 "Monthly Payment_2"

. 
. replace intst_rate = intst_rate*100*12
(84,996 real changes made)

. 
. *check the missings. 
. forvalues x = 1/2 {
  2. gen double obs_`x' = (intst_rate + loan_sub + urban + hhsize + head_female + head_age + mrtg_`x'_borrow + loan_period_`x' + repay_mt_`x') != . //obsevations will full loan information
  3. mdesc intst_rate loan_sub urban hhsize head_female head_age mrtg_`x'_borrow loan_period_`x' repay_mt_`x' if mrtg_`x'_borrow > 0 & obs_`x' == 1
  4. }

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     intst_rate |           0          3,244           0.00
       loan_sub |           0          3,244           0.00
          urban |           0          3,244           0.00
         hhsize |           0          3,244           0.00
    head_female |           0          3,244           0.00
       head_age |           0          3,244           0.00
   mrtg_1_bor~w |           0          3,244           0.00
   loan_perio~1 |           0          3,244           0.00
     repay_mt_1 |           0          3,244           0.00
----------------+-----------------------------------------------

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     intst_rate |           0          3,936           0.00
       loan_sub |           0          3,936           0.00
          urban |           0          3,936           0.00
         hhsize |           0          3,936           0.00
    head_female |           0          3,936           0.00
       head_age |           0          3,936           0.00
   mrtg_2_bor~w |           0          3,936           0.00
   loan_perio~2 |           0          3,936           0.00
     repay_mt_2 |           0          3,936           0.00
----------------+-----------------------------------------------

. 
. *creat the tables. 
. forvalues i = 1(1)5 {
  2.   forvalues x = 1/2 {
  3.     qui eststo total_`x' : estpost summarize mrtg_`x'_borrow loan_period_`x' repay_mt_`x' $var_tab_2 [aw = hhwgt] if mrtg_`x'_borrow > 0 & obs_`x' == 1,de
  4.     qui eststo qtl_`i'_`x' : estpost summarize mrtg_`x'_borrow loan_period_`x' repay_mt_`x' $var_tab_2 [aw = hhwgt] if qtl == `i' & mrtg_`x'_borrow > 0 & obs_`x' == 1,de
  5.   }
  6. }

. 
. forvalues x = 1/2 {
  2. esttab total_`x' qtl_1_`x' qtl_2_`x' qtl_3_`x' qtl_4_`x' qtl_5_`x', cells(mean(fmt(%15.0fc))) label collabels(none) ///
>  mtitles("All" "Q1" "Q2" "Q3" "Q4" "Q5") stats(N, label("Observations") fmt(%15.0gc)) ///
>  title("Table 3.1 Summary Statistics of Mortgages (mean)_`x' by Wealth Quintile") varwidth(40) ///
>  addnotes("Notes: Households weighted by survey weights.",  ///
>           "       The term of loan is imputed by monthly payment, interest rate, and the mortgage value at inception.")
  3. }

Table 3.1 Summary Statistics of Mortgages (mean)_1 by Wealth Quintile
----------------------------------------------------------------------------------------------------------------------
                                                  (1)          (2)          (3)          (4)          (5)          (6)
                                                  All           Q1           Q2           Q3           Q4           Q5
----------------------------------------------------------------------------------------------------------------------
Mortgage Value at Inception_1                 668,650      566,659      162,931      322,642      396,728      836,772
Term of Loan_1 (mt)                               157          127          218          164          174          152
Monthly Payment_1                              11,963        9,203        5,518        6,403        8,485       14,464
Interest rate (%)                                  11           11           15           14           12           11
Subsidized (%)                                     93           96           77           84           88           97
Urban Household (%)                                71           56           36           60           62           80
Household Size                                      5            5            5            4            5            4
Female Household Head (%)                           8           11           15            7            9            7
Household Head Age                                 49           45           46           48           53           49
----------------------------------------------------------------------------------------------------------------------
Observations                                    3,244          140          117          253          736        1,998
----------------------------------------------------------------------------------------------------------------------
Notes: Households weighted by survey weights.
,
       The term of loan is imputed by monthly payment, interest rate, and the mortgage value at inception.

Table 3.1 Summary Statistics of Mortgages (mean)_2 by Wealth Quintile
----------------------------------------------------------------------------------------------------------------------
                                                  (1)          (2)          (3)          (4)          (5)          (6)
                                                  All           Q1           Q2           Q3           Q4           Q5
----------------------------------------------------------------------------------------------------------------------
Mortgage Value at Inception_2                 598,155      503,524      125,207      222,684      356,985      790,816
Term of Loan_2 (mt)                               160          140          204          177          195          144
Monthly Payment_2                              11,076        8,430        4,161        4,732        7,413       14,278
Interest rate (%)                                  12           13           14           15           12           11
Subsidized (%)                                     91           86           73           78           89           96
Urban Household (%)                                68           60           32           50           56           80
Household Size                                      4            5            4            4            5            4
Female Household Head (%)                           9           10           11           13           10            8
Household Head Age                                 49           44           44           47           51           49
----------------------------------------------------------------------------------------------------------------------
Observations                                    3,936          192          174          359          936        2,275
----------------------------------------------------------------------------------------------------------------------
Notes: Households weighted by survey weights.
,
       The term of loan is imputed by monthly payment, interest rate, and the mortgage value at inception.

. 
. forvalues x = 1/2 {
  2. esttab total_`x' qtl_1_`x' qtl_2_`x' qtl_3_`x' qtl_4_`x' qtl_5_`x', cells(p50(fmt(%15.0fc))) label collabels(none) ///
>  mtitles("All" "Q1" "Q2" "Q3" "Q4" "Q5") stats(N, label("Observations") fmt(%15.0gc)) ///
>  title("Table 3.2 Summary Statistics of Mortgages (med)_`x' by Wealth Quintile") varwidth(40) ///
>  addnotes("Notes: Households weighted by survey weights.",  ///
>           "       The term of loan is imputed by monthly payment, interest rate, and the mortgage value at inception.")
  3. }

Table 3.2 Summary Statistics of Mortgages (med)_1 by Wealth Quintile
----------------------------------------------------------------------------------------------------------------------
                                                  (1)          (2)          (3)          (4)          (5)          (6)
                                                  All           Q1           Q2           Q3           Q4           Q5
----------------------------------------------------------------------------------------------------------------------
Mortgage Value at Inception_1                 400,000      150,000       74,000      180,000      278,000      500,000
Term of Loan_1 (mt)                               102           71           55           72           85          123
Monthly Payment_1                               6,250        3,200        2,222        4,714        4,200        8,200
Interest rate (%)                                  11           12           13           12           11           11
Subsidized (%)                                    100          100          100          100          100          100
Urban Household (%)                               100          100            0          100          100          100
Household Size                                      4            4            4            4            4            4
Female Household Head (%)                           0            0            0            0            0            0
Household Head Age                                 48           40           47           47           50           48
----------------------------------------------------------------------------------------------------------------------
Observations                                    3,244          140          117          253          736        1,998
----------------------------------------------------------------------------------------------------------------------
Notes: Households weighted by survey weights.
,
       The term of loan is imputed by monthly payment, interest rate, and the mortgage value at inception.

Table 3.2 Summary Statistics of Mortgages (med)_2 by Wealth Quintile
----------------------------------------------------------------------------------------------------------------------
                                                  (1)          (2)          (3)          (4)          (5)          (6)
                                                  All           Q1           Q2           Q3           Q4           Q5
----------------------------------------------------------------------------------------------------------------------
Mortgage Value at Inception_2                 300,000      150,000       50,000      100,000      200,000      500,000
Term of Loan_2 (mt)                                97           72           55           73           85          114
Monthly Payment_2                               5,556        3,200        1,500        2,500        3,690        7,700
Interest rate (%)                                  11           13           13           12           11           11
Subsidized (%)                                    100          100          100          100          100          100
Urban Household (%)                               100          100            0            0          100          100
Household Size                                      4            4            4            4            4            4
Female Household Head (%)                           0            0            0            0            0            0
Household Head Age                                 47           39           43           46           49           48
----------------------------------------------------------------------------------------------------------------------
Observations                                    3,936          192          174          359          936        2,275
----------------------------------------------------------------------------------------------------------------------
Notes: Households weighted by survey weights.
,
       The term of loan is imputed by monthly payment, interest rate, and the mortgage value at inception.

. 
. *******************************************************************
. *** Table 4. creat the tables for the imputed 
. *******************************************************************
. use "${r_output}\b14_hse_mortgage",clear

. 
. label var mrtg_1_borrow "Mortgage Value at Inception_1"

. label var mrtg_2_borrow "Mortgage Value at Inception_2"

. label var loan_period_1 "Term of Loan_1 (mt)"

. label var loan_period_2 "Term of Loan_2 (mt)"

. label var intst_rate "Interest rate (%)"

. label var repay_mt_1 "Monthly Payment_1"

. label var repay_mt_2 "Monthly Payment_2"

. 
. keep if mrtg_1_borrow > 0 | mrtg_2_borrow > 0 //only keep housing mortgage
(140,603 observations deleted)

. 
. **check missing values
. //loan features: repay_mt_`i' intst_rate loan_period_`i'
. 
. forvalues i = 1/2 {
  2. gen repay_intst_`i' = (repay_mt_`i' + intst_rate)
  3. label var repay_intst_`i' "Both payment and interest exist_`i'"
  4. 
. gen repay_term_`i' = (repay_mt_`i' + loan_period_`i') 
  5. label var repay_term_`i' "Both payment and term of loan exist_`i'"
  6. 
. gen intst_term_`i' = (intst_rate + loan_period_`i') 
  7. label var intst_term_`i' "Both interest and term of loan exist_`i'"
  8. 
. gen repay_intst_term_`i' = (repay_mt_`i' + intst_rate + loan_period_`i') 
  9. label var repay_intst_term_`i' "All the three features exist_`i'"
 10. }
(1,483 missing values generated)
(3,677 missing values generated)
(3,677 missing values generated)
(3,677 missing values generated)
(1,483 missing values generated)
(2,985 missing values generated)
(2,985 missing values generated)
(2,985 missing values generated)

. 
. forvalues i = 1/2 {
  2. //combination missing status. 
. mdesc repay_mt_`i' intst_rate loan_period_`i' repay_intst_`i' repay_term_`i' intst_term_`i' repay_intst_term_`i' 
  3. }

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     repay_mt_1 |       1,476          6,921          21.33
     intst_rate |          11          6,921           0.16
   loan_perio~1 |       3,677          6,921          53.13
   repay_in~t_1 |       1,483          6,921          21.43
   repay_term_1 |       3,677          6,921          53.13
   intst_term_1 |       3,677          6,921          53.13
   repay_in~m_1 |       3,677          6,921          53.13
----------------+-----------------------------------------------

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     repay_mt_2 |       1,476          6,921          21.33
     intst_rate |          11          6,921           0.16
   loan_perio~2 |       2,985          6,921          43.13
   repay_in~t_2 |       1,483          6,921          21.43
   repay_term_2 |       2,985          6,921          43.13
   intst_term_2 |       2,985          6,921          43.13
   repay_in~m_2 |       2,985          6,921          43.13
----------------+-----------------------------------------------

. 
. **impute borrowed amont using payment and insterest rate and demography
. forvalues i = 1/2 {
  2. areg mrtg_`i'_borrow repay_mt_`i' intst_rate urban head_age qtl hhsize,a(year) r
  3. predict mrtg_`i'_borrow_est
  4. replace mrtg_`i'_borrow_est  = . if mrtg_`i'_borrow > 0 | mrtg_`i'_borrow_est<0 //only keep the estimate when the original value is missing. 
  5. sum mrtg_`i'_borrow*
  6. }

Linear regression, absorbing indicators         Number of obs     =      5,438
Absorbed variable: year                         No. of categories =         28
                                                F(   6,   5404)   =     146.67
                                                Prob > F          =     0.0000
                                                R-squared         =     0.3694
                                                Adj R-squared     =     0.3656
                                                Root MSE          =  6.467e+05

------------------------------------------------------------------------------
             |               Robust
mrtg_1_bor~w |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  repay_mt_1 |   31.78581   3.383802     9.39   0.000      25.1522    38.41943
  intst_rate |   -8692551   916948.4    -9.48   0.000    -1.05e+07    -6894962
       urban |   2272.934   169.3461    13.42   0.000     1940.947     2604.92
    head_age |  -717.1575   728.2046    -0.98   0.325    -2144.732     710.417
         qtl |   45141.54   9673.321     4.67   0.000     26177.93    64105.15
      hhsize |  -9870.838   5188.403    -1.90   0.057     -20042.2     300.523
       _cons |   92574.58   51884.43     1.78   0.074    -9139.811      194289
------------------------------------------------------------------------------
(option xb assumed; fitted values)
(1,483 missing values generated)
(4,442 real changes made, 4,442 to missing)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
mrtg_1_bor~w |      6,921    442127.8    779317.7          0   1.30e+07
mrtg_1_bor~t |        996    260382.6    130003.5   1133.795   510604.3

Linear regression, absorbing indicators         Number of obs     =      5,438
Absorbed variable: year                         No. of categories =         28
                                                F(   6,   5404)   =     155.82
                                                Prob > F          =     0.0000
                                                R-squared         =     0.3582
                                                Adj R-squared     =     0.3543
                                                Root MSE          =  6.677e+05

------------------------------------------------------------------------------
             |               Robust
mrtg_2_bor~w |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
  repay_mt_2 |   29.57799   3.253879     9.09   0.000     23.19908    35.95691
  intst_rate |   -9473238    1009597    -9.38   0.000    -1.15e+07    -7494021
       urban |   2515.166   178.9157    14.06   0.000     2164.419    2865.913
    head_age |  -632.3291   755.3328    -0.84   0.403    -2113.086    848.4277
         qtl |   48420.54   9734.588     4.97   0.000     29336.83    67504.26
      hhsize |  -8641.947   5122.106    -1.69   0.092    -18683.34    1399.445
       _cons |   95971.76   53036.48     1.81   0.070    -8001.118    199944.6
------------------------------------------------------------------------------
(option xb assumed; fitted values)
(1,483 missing values generated)
(5,435 real changes made, 5,435 to missing)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
mrtg_2_bor~w |      6,921    494401.9    794880.9          0   1.50e+07
mrtg_2_bor~t |          3    291068.7      183885   85796.04   440726.7

. 
. forvalues i = 1/2 {
  2. br mrtg_`i'_borrow_est intst_rate repay_mt_`i' if mrtg_`i'_borrow_est > 0
  3. replace intst_rate = . if intst_rate == 0
  4. replace repay_mt_`i' = . if repay_mt_`i' == 0
  5. gen double obs_`i' = (intst_rate + mrtg_`i'_borrow_est + repay_mt_`i') != . //obsevations have enough information to impute loan period
  6. tab obs_`i' //no complete data for imputation. 
  7. }
(115 real changes made, 115 to missing)
(1,299 real changes made, 1,299 to missing)

      obs_1 |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      6,921      100.00      100.00
------------+-----------------------------------
      Total |      6,921      100.00
(0 real changes made)
(326 real changes made, 326 to missing)

      obs_2 |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      6,921      100.00      100.00
------------+-----------------------------------
      Total |      6,921      100.00

. 
. log close
      name:  <unnamed>
       log:  C:\Users\wb500886\OneDrive - WBG\7_Housing\survey_all\Housing_git\nss\Survey_NSS\NSS70\03_NSS70_Table of Means.log
  log type:  text
 closed on:  20 Nov 2020, 04:24:47
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
